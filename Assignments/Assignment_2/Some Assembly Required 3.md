# PicoGym Web Exploitation Writeup


Author: [Ankur Kumar](https://github.com/awsoankur) 

Challenge Page: [Some Assembly Required 3](http://mercury.picoctf.net:60022/index.html)

## Walkthrough
following same procedure as Some Assembly Required 2 we get to the pseudocode of the wasm file.
there too we notice changes in the same copy function.
upon spending a lot of time on understanding the code we get that the function
takes `a` and XOR it with an elemnt from the array at memory address 1067 
and stores it at memoryaddress
1072 + b which is given to us in the data as an array of hexes.
converting the code to C we get the array of hexes both the encoded flag and the key to XORed with.
`flag=[0x9d, 0x6e, 0x93, 0xc8, 0xb2, 0xb9, 0x41, 0x8b, 0xc5, 0xc6, 0xdd, 0x61, 
  0x93, 0xc3, 0xc2, 0xda, 0x3f, 0xc7, 0x93, 0xc1, 0x8b, 0x31, 0x95, 0x93, 
  0x93, 0x8e, 0x62, 0xc8, 0x94, 0xc9, 0xd5, 0x64, 0xc0, 0x96, 0xc4, 0xd9, 
  0x37, 0x93, 0x93, 0xc2, 0x90, 0x00, 0x00]`
  this is what we get for the encrytped flag.
`key =[0xf1, 0xa7, 0xf0, 0x07, 0xed]`
these are the keys.
the keys are not ordered so to order them we have to manullly decode the first 4 through 
trial and error and then reorder the keys array for the proper functioning. 

The following code exectues the logic suggested:
`from pwn import xor
flag=[0x9d, 0x6e, 0x93, 0xc8, 0xb2, 0xb9, 0x41, 0x8b, 0xc5, 0xc6, 0xdd, 0x61, 
  0x93, 0xc3, 0xc2, 0xda, 0x3f, 0xc7, 0x93, 0xc1, 0x8b, 0x31, 0x95, 0x93, 
  0x93, 0x8e, 0x62, 0xc8, 0x94, 0xc9, 0xd5, 0x64, 0xc0, 0x96, 0xc4, 0xd9, 
  0x37, 0x93, 0x93, 0xc2, 0x90, 0x00, 0x00]
key =[0xed ,0x07, 0xf0, 0xa7, 0xf1]
for i in range(len(flag)):
  print(xor(flag[i],key[i%5]).decode(),sep='',end='')`


## Flag
`picoCTF{b70fcd378740f6e4bce8388c01540c43}`
